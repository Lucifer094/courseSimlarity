《Windows程序设计(API)》是计算机科学与技术专业的一门专业发展选修课，实践性很强，主要目的是培养学生理解开发Windows操作系统管理下的应用程序的各种支撑技术，掌握这些技术进行程序开发的基本技能，熟悉和掌握利用API开发Windows应用程序的基本步骤、思路。。Windows是个人计算机上最流行的操作系统，Windows操作系统交互性友好，应用广泛，在国内外拥有众多家庭和商务用户。用户常提出运行于Windows系统的应用软件各种功能需求，因此Windows应用程序设计可以说是程序员的基础必修课。从个人技能层面说，学生毕业即可在与Windows应用开发相关的岗位直接上岗，工作可塑性大，发展前途大，各高校许多专业都开设了相关的课程。基本内容：要求在本课程学习过程中，学生要能实现利用各种Windows支撑技术的应用程序实例，包含掌握的技术内容如下：1.窗口管理与消息事件驱动2.字符编程处理3.键盘与鼠标输入输出4.资源管理270本科理论课程教学大纲（2014版）5.图形图像应用编程6.线程管理技术、进程间通信7.动态链接库选用教材：《Windows程序设计》，CharlesPetzold主编，方敏张胜、梁路平译，清华大学出版社，2010年第5版参考书目：1．《×××××》，主编/∕著，×××××出版社，××年第××版2．……二、课程教育目标理论和知识方面：1．理解Unicode宽字符集与窄字符集编码原则，理解两种字符集的转换方法，掌握两种字符集定义与相关字符串处理函数调用要求，掌握通用的字符串定义方法，理解字符集编译选项的设置方法2．掌握windows的窗口消息机制，Windows对应用程序的管理机制；3．掌握Windows资源管理技术；4．掌握键盘鼠标消息获取方法与消息参数，以及窗口文本输出输入技术。5．掌握Windows系统的图形输出，图像显示处理技术6．掌握动态链接库的原理与程序开发方法。7．掌握进程与线程设计技术，掌握进程间通信技术8．理解多媒体编程的方法能力和技能方面：1．能编写窗口程序，能设计并管理资源，能针对不同的Windows消息正确处理。2．能编写正确处理鼠标键盘消息程序。3．能理解Windows的图形处理函数编写简单图形绘制的程序，能理解图像处理函数，编写简单图像输出程序4．掌握Windows动态链接库程序设计方法。5．掌握Windows线程程序，能应用进程间通信技术编写多进程程序271本科理论课程教学大纲（2014版）三、课程学时分配章内容学时第一章Unicode宽字符集与窄字符集3第二章Windows窗口与消息机制6第三章Windows窗口文字与图形处理3第四章Windows系统键盘与鼠标处理3第五章Windows应用程序资源管理6第六章多线程程序设计3第七章动态链接库程序设计3第八章进程间通信程序设计6第九章Windows系统图像处理程序设计3四、课程教学内容、要求、重难点及学时安排例：第一章Unicode宽字符集与窄字符集【教学内容】1．字符集简介：美国资讯交换标准码ASCII，扩展ASCII，双位元组字元集（DBCS），Unicode宽字符集简介2．宽字符的定义与使用3．宽字符与ASCII的字符类型的程序兼容设计4．Windows对宽字符与ASCII字符类型定义的程序兼容设计5．有字符参数的Windows函数调用处理【教学要求】，学习字符集编码原理，掌握不同字符集程序设计1．理解ASCII字符集与Unicode宽字符集2．掌握定义ASCII字符与Unicode宽字符方法3．掌握需要提供字符参数的Windows函数调用时的处理方法【重点、难点】1．重点：ASCII字符与Unicode宽字符类型定义时的区别，宽字符与ASCII的字符类型通用性定义（写明本章节内容中最重要或最基础或最关键的内容。）2．难点：ASCII字符与Unicode宽字符字符集编码规定，宽字符与ASCII的字符类型通用性定义，Windows接收字符参数的函数通用性调用。【教学方法】讲授法、讨论法、案例法、实验法、练习法272本科理论课程教学大纲（2014版）第二章Windows窗口与消息机制【学时安排】3学时【教学内容】1．Windows应用程序的窗口与消息：基于窗口的应用程序运行过程2．Windows窗口应用程序代码的基本结构：主函数设计并注册窗口类，由窗口类调用窗口创建函数，消息循环，接收窗口消息并处理消息的窗口函数。3．窗口类成员作用：注册窗口类的各个成员的作用4．Windows消息：应用程序常需要处理的Windows各种消息的作用，对各种消息处理的要求。5．窗口函数：注册类窗口类函数、创建窗口函数、显示窗口、消息循环相关函数、默认消息处理得函数，等函数的功能与参数的作用，【教学要求】，学习基于消息机制的Windows的窗口应用程序设计，掌握不同消息的处理要求1．理解窗口应用程序运行过程2．掌握编写一个有窗口应用程序的基本代码结构3．理解与窗口相关的常见函数的功能及其参数的含义。4．掌握一些常见消息的含义以及编写消息处理代码的要求【重点、难点】1．重点：窗口应用程序运行过程，窗口应用程序的基本代码结构，与窗口相关的常见函数的功能，常见消息的含义以及编写消息处理代码的要求。2．难点：窗口应用程序的基本代码结构，常见消息的含义以及编写消息处理代码的要求。【教学方法】讲授法、讨论法、案例法、实验法、练习法【学时安排】6学时【教学内容】第三章Windows窗口文字与图形处理1．设备内容句柄：设备内容句柄控制输出的文字与图形的相关属性，设备内容句柄的获取途经，GetDC函数、WM_PAINT消息产生时。2．绘图数据结构PAINTSTRUCT：主函数设计并注册窗口类，由窗口类调用窗口创建函数，消息循环，接收窗口消息并处理消息的窗口函数。3．文字输出相关API函数：掌握一些与文字相关的函数功能，了解文字属273性设置的函数，比如：TextOut、DrawText、SetTextColor本科理论课程教学大纲（2014版）4．设备内容句柄属性值获取与设置：设置与获取设备内容句柄属性，函数SelectObject的功能。5．系统字体与文字格式化：系统字体参数获取，创建字体，比如函数CreateFont6．窗体滚动栏与滚动消息：文字多页显示的处理。7．WM_PAINT消息与有效矩形和无效矩形：WM_PAINT消息下代码编写要求8．基本图形的绘制【教学要求】，学习Windows的文字的输出功能，理解窗口无效区域的显示处理1．掌握窗口设备内容句柄的作用与编程应用2．了解绘图数据结构的作用3．掌握与窗口相关的文字输出API函数。4．掌握设备内容句柄属性值获取与设置函数与编程方法5．掌握窗体滚动栏与滚动消息的程序编写方法6．熟悉WM_PAINT消息与有效矩形和无效矩形【重点、难点】1．重点：窗口设备内容句柄的作用与编程应用，窗口相关的文字输出API函数，设备内容句柄属性值获取与设置函数与编程方法，窗体滚动栏与滚动消息的程序编写方法，WM_PAINT消息与有效矩形和无效矩形2．难点：设备内容句柄属性值获取与设置函数与编程方法，窗体滚动栏与滚动消息的程序编写方法，有效矩形和无效矩形。【教学方法】讲授法、讨论法、案例法、练习法【学时安排】3学时【教学内容】第四章Windows系统键盘与鼠标处理1．Windows系统窗口焦点：具有输入焦点的窗口才能获取键盘输入。2．按键消息内容：系统按键WM_SYSKEYDOWN、WM_SYSKEYUP；非系统按键WM_KEYDOWN、WM_KEYUP，虚拟键码。3．处理控制键的处理：274本科理论课程教学大纲（2014版）4．鼠标消息处理：设置与获取设备内容句柄属性，函数SelectObject的功能。5．鼠标消息的特殊属性处理：【教学要求】，学习Windows应用程序的键盘与鼠标输入处理。1．熟悉Windows系统窗口焦点的作用与设置2．掌握按键消息的各种类型，按键消息包含的内容3．熟悉控制键的编程方法4．掌握鼠标消息的作用与包含的内容，掌握鼠标消息编程方法5．熟悉鼠标消息的特殊编程处理【重点、难点】1．重点：窗口焦点，键盘消息，鼠标消息。2．难点：系统键消息与控制键消息，鼠标消息的特殊情况。【教学方法】讲授法、案例法、实验法、练习法【学时安排】3学时【教学内容】第五章Windows应用程序资源管理1．Windows资源简介：应用程序资源的作用与资源管理技术2．图标资源：图标资源设计与应用程序中利用图标资源的方法。3．菜单资源：菜单资源设计与应用程序中利用菜单资源设计菜单的方法。4．对话框资源：对话框资源设计与应用程序中利用对话框资源设计对话框的方法。5．其他资源：鼠标资源、版本资源，字符串资源【教学要求】，学习Windows的资源管理原理与资源应用方法1．掌握Windows资源的管理技术，已经应用程序利用资源设计程序的一般方法2．掌握应用程序中利用图标资源设计程序的方法3．掌握应用程序中利用菜单资源设计菜单方法。4．掌握应用程序中利用对话框资源设计对话框程序的方法。5．熟悉利用其他资源设计程序的方法【重点、难点】1．重点：利用图标资源设计程序的方法，利用菜单资源设计菜单方法，利275用对话框资源设计对话框程序的方法。本科理论课程教学大纲（2014版）2．难点：利用菜单资源设计菜单方法，利用对话框资源设计对话框程序的方法。【教学方法】讲授法、讨论法、案例法、实验法、练习法【学时安排】6学时【教学内容】第六章多线程程序设计1．Windows资源简介：应用程序资源的作用与资源管理技术2．图标资源：图标资源设计与应用程序中利用图标资源的方法。3．菜单资源：菜单资源设计与应用程序中利用菜单资源设计菜单的方法。4．对话框资源：对话框资源设计与应用程序中利用对话框资源设计对话框的方法。5．其他资源：鼠标资源、版本资源，字符串资源【教学要求】，学习Windows对线程的管理技术以及编写线程程序的方法1．掌握Windows资源的管理技术，已经应用程序利用资源设计程序的一般方法2．掌握应用程序中利用图标资源设计程序的方法3．掌握应用程序中利用菜单资源设计菜单方法。4．掌握应用程序中利用对话框资源设计对话框程序的方法。5．熟悉利用其他资源设计程序的方法【重点、难点】1．重点：利用图标资源设计程序的方法，利用菜单资源设计菜单方法，利用对话框资源设计对话框程序的方法。2．难点：利用菜单资源设计菜单方法，利用对话框资源设计对话框程序的方法。【教学方法】讲授法、案例法、实验法、练习法【学时安排】3学时【教学内容】第七章动态链接库程序设计1．Windows系统动态链接库技术原理：Windows系统管理动态链接库技术、2．动态链接库的出入口函数原型：函数名，函数参数，返回值，动态链接276库装入内存时的初始化，退出时资源释放。本科理论课程教学大纲（2014版）3．动态链接库提供对外访问API：动态链接库提供应用程序调用的外部函数。4．VS中设计动态链接库时的语法规范【教学要求】，学习Windows的动态链接库原理与设计动态链接库程序的方法1．熟悉Windows系统动态链接库技术原理2．掌握动态链接库的出入口的功能与函数原型3．掌握动态链接库提供对外访问API的原型申明。4．掌握VS中设计动态链接库时的语法规范。【重点、难点】1．重点：Windows系统动态链接库技术原理，动态链接库的出入口的功能与函数原型，动态链接库提供对外访问API的原型申明，VS中设计动态链接库时的语法规范。2．难点：Windows系统动态链接库技术原理，VS中设计动态链接库时的语法规范。【教学方法】讲授法、案例法、实验法、练习法【学时安排】3学时【教学内容】第八章进程间通信程序设计1．Windows资源简介：应用程序资源的作用与资源管理技术2．图标资源：图标资源设计与应用程序中利用图标资源的方法。3．菜单资源：菜单资源设计与应用程序中利用菜单资源设计菜单的方法。4．对话框资源：对话框资源设计与应用程序中利用对话框资源设计对话框的方法。5．其他资源：鼠标资源、版本资源，字符串资源【教学要求】，学习Windows的进程通信技术，掌握利用进程通信技术编写程序的方法。1．掌握Windows资源的管理技术，已经应用程序利用资源设计程序的一般方法2．掌握应用程序中利用图标资源设计程序的方法3．掌握应用程序中利用菜单资源设计菜单方法。277本科理论课程教学大纲（2014版）4．掌握应用程序中利用对话框资源设计对话框程序的方法。5．熟悉利用其他资源设计程序的方法【重点、难点】1．重点：利用图标资源设计程序的方法，利用菜单资源设计菜单方法，利用对话框资源设计对话框程序的方法。2．难点：利用菜单资源设计菜单方法，利用对话框资源设计对话框程序的方法。【教学方法】讲授法、讨论法、案例法、实验法、练习法【学时安排】6学时第九章Windows系统图像处理程序设计【教学内容】1．Windows资源简介：应用程序资源的作用与资源管理技术2．图标资源：图标资源设计与应用程序中利用图标资源的方法。3．菜单资源：菜单资源设计与应用程序中利用菜单资源设计菜单的方法。4．对话框资源：对话框资源设计与应用程序中利用对话框资源设计对话框的方法。5．其他资源：鼠标资源、版本资源，字符串资源【教学要求】，学习Windows的图像处理技术，编写基本的图像输出程序1．掌握Windows资源的管理技术，已经应用程序利用资源设计程序的一般方法2．掌握应用程序中利用图标资源设计程序的方法3．掌握应用程序中利用菜单资源设计菜单方法。4．掌握应用程序中利用对话框资源设计对话框程序的方法。5．熟悉利用其他资源设计程序的方法【重点、难点】1．重点：利用图标资源设计程序的方法，利用菜单资源设计菜单方法，利用对话框资源设计对话框程序的方法。2．难点：利用菜单资源设计菜单方法，利用对话框资源设计对话框程序的方法。【教学方法】讲授法、案例法、实验法、练习法【学时安排】3学时278本科理论课程教学大纲（2014版）